# λ©μ°¨

1. μ „μ²΄ κ·Έλ¦Ό μ”μ•½
   1. ν΄λΌμ΄μ–ΈνΈ
   2. controller
   3. service
   4. DAO/Repository
   5. DB
2. DTO
   1. Request DTO
   2. Response DTO
3. Entity
4. μΈμ¦, μΈκ°€
   1. μΈμ¦
   2. μΈκ°€

<img src="./img/1.png">

# π’› 1. μ „μ²΄ κ·Έλ¦Ό μ”μ•½

ν΄λΌμ΄μ–ΈνΈ μ”μ²­ -> μ»¨νΈλ΅¤λ¬κ°€ λ°›μ -> μ„λΉ„μ¤κ°€ μ²λ¦¬ -> DB μ—μ„ κΊΌλ‚΄μ„ -> λ‹¤μ‹ ν΄λΌμ΄μ–ΈνΈλ΅ λ³΄λ‚΄μ¤

## 1-1. ν΄λΌμ΄μ–ΈνΈ

- μ”μ²­ν•λ” μ½

  - ex. μ›Ή λΈλΌμ°μ €, λ¨λ°”μΌ μ•±, ν”„λ΅ νΈμ—”λ“(JS, React λ“±)

- μ„λ²„μ— GET λλ” POST μ”μ²­
- λ³΄ν†µ μ”μ²­/μ‘λ‹µμ€ JSON ν•μ‹μΌλ΅ μ£Όκ³ λ°›μ

## 1-2. controller(API Layer)

- ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ μ”μ²­(JSON)μ„ λ°›μ
- κ·Έ λ°μ΄ν„°λ¥Ό DTOλ΅ λ³€ν™
- service μ— μΌμ„ μ‹ν‚΄
- service μ—μ„ μ²λ¦¬λ κ²°κ³Όλ¥Ό λ‹¤μ‹ ν΄λΌμ΄μ–ΈνΈμ—κ² JSON μΌλ΅ λλ ¤μ¤

### μμ‹

| μƒμμ μΉΈ (μ •λ³΄ μ΄λ¦„) | λ‹΄λ” λ‚΄μ© (λ°μ΄ν„°) | μ„¤λ…        |
| :-------------------- | :----------------- | :---------- |
| **`name`** (μ΄λ¦„)     | "κΉ€μ² μ"           | μΉκµ¬μ μ΄λ¦„ |
| **`age`** (λ‚μ΄)      | "7"                | μΉκµ¬μ λ‚μ΄ |
| **`nickname`** (λ³„λ…) | "λ€μ¥"             | μΉκµ¬μ λ³„λ… |

## 1-3. service(Business Logic)

- μ‹¤μ  λ΅μ§μ„ μ²λ¦¬ν•λ” κ³³
- ν•„μ”ν• λ°μ΄ν„°λ” DAO(repository) μ— λ¶€νƒν•΄μ„ DB μ—μ„ κ°€μ Έμ΄

## 1-4. DAO/Repository(Persistence Logic)

- DB λ‘ μ§μ ‘ μ†ν†µν•λ” κ³³
- SQL μ„ λ‚ λ¦¬κ±°λ‚, JPA λ΅ DB λ°μ΄ν„°λ¥Ό μ΅°ν/μ €μ¥
- ex. `findById(1)` -> DB μ—μ„ id = 1 μΈ λ°μ΄ν„°λ¥Ό μ°Ύμ•„μ„ κ°μ²΄λ΅ λ°ν™

## 1-5. DB(Database)

- MySQL, H2, PostgreSQL κ°™μ€ λ°μ΄ν„°λ² μ΄μ¤

## μ •λ¦¬

| κµ¬λ¶„       | μ—­ν•                       | μμ‹                  |
| ---------- | ------------------------- | --------------------- |
| client     | μ‚¬μ©μ μ”μ²­μ„ λ³΄λƒ„        | β€μ μ € μ •λ³΄ λ³΄μ—¬μ¤β€    |
| controller | μ”μ²­ λ°›κΈ° & μ‘λ‹µ λλ ¤μ£ΌκΈ° | `/api/users` μ²λ¦¬     |
| service    | λΉ„μ¦λ‹μ¤ λ΅μ§             | μ μ € κ²€μ¦, κ³„μ‚° λ“±    |
| repository | DB μ ‘κ·Ό                   | SQL μ‹¤ν–‰, λ°μ΄ν„° μ΅°ν |
| DB         | μ‹¤μ  λ°μ΄ν„° μ €μ¥          | users ν…μ΄λΈ”          |

# 2. DTO(Data Transfer AObject)

- λ°μ΄ν„° μ „μ†΅ κ°μ²΄(Data Transfer Object) μ μ•½μλ΅, μ—¬λ¬ κ³„μΈµ κ°„μ— λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›κΈ° μ„ν•΄ μ‚¬μ©λλ” κ°μ²΄

## μΆ…λ¥

### 2-1. Request DTO

- ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—κ² μ •λ³΄λ¥Ό λ³΄λ‚Ό λ• μ“°λ” μƒμ

- λ©μ : μ„λ²„κ°€ μ–΄λ–¤ μ‘μ—…μ„ μν–‰ν•κΈ° μ„ν•΄ ν•„μ”ν• μµμ†ν•μ λ°μ΄ν„° μ „λ‹¬

- λ‹΄λ” λ‚΄μ©: ν΄λΌμ΄μ–ΈνΈκ°€ μ…λ ¥ν•κ±°λ‚ μ κ³µν• μ •λ³΄
  - ex. νμ›κ°€μ…: μ•„μ΄λ””, λΉ„λ°€λ²νΈ, μ΄λ¦„
  - ex. κ²μ‹κΈ€ μƒμ„±: μ λ©, λ‚΄μ©

### 2-2. Response DTO

- μ„λ²„κ°€ μ‘μ—…μ„ λ§μΉκ³  ν΄λΌμ΄μ–ΈνΈμ—κ² κ²°κ³Όλ¥Ό λλ ¤μ¤„ λ• μ“°λ” μƒμ

- λ©μ : ν΄λΌμ΄μ–ΈνΈ ν™”λ©΄μ— λ³΄μ—¬μ£Όκ±°λ‚ λ‹¤μμ— μ‚¬μ©ν•  λ°μ΄ν„° μ κ³µ

- λ‹΄λ” λ‚΄μ©: ν™”λ©΄μ— ν•„μ”ν• μ •λ³΄, μ„λ²„κ°€ μ¶”κ°€ν• μ •λ³΄

  - ex. νμ›κ°€μ… κ²°κ³Ό: μƒλ΅ λ§λ“¤μ–΄μ§„ νμ›μ κ³ μ  id, μ΄λ¦„, κ°€μ… μ„±κ³µ λ©”μ‹μ§€
  - ex. κ²μ‹κΈ€ μ΅°ν: κ²μ‹κΈ€μ κ³ μ  id, μ λ©, λ‚΄μ©, μ‘μ„±μΌμ, μ΅°νμ

3. Entity

- μ„λ²„ λ‚΄λ¶€μ—μ„ λ°μ΄ν„°λ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν• ν•µμ‹¬ κ°μ²΄

- μ›λ³Έ: DB ν…μ΄λΈ” κµ¬μ΅°μ™€ 1:1 λ΅ λ€μ‘ν•λ©°, λ¨λ“  μ›λ³Έ λ°μ΄ν„°λ¥Ό λ‹΄κ³  μμ

-> λ”°λΌμ„, μ„λ²„λ” entity λ¥Ό response DTO λ΅ λ³€ν™ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ—κ² μ‘λ‹µν•λ” κ²ƒμ΄ μΌλ°μ μΈ μ›μΉ™μ„

## λ‚λ μ„ μ“°λ” μ΄μ 

| κµ¬λ¶„             | Request DTO (μ”μ²­)                            | Response DTO (μ‘λ‹µ)                              |
| :--------------- | :-------------------------------------------- | :----------------------------------------------- |
| **λ©μ **         | μ„λ²„κ°€ μ‘μ—…μ„ **μν–‰**ν•κΈ° μ„ν• λ°μ΄ν„° μ „λ‹¬   | ν΄λΌμ΄μ–ΈνΈμ—κ² **κ²°κ³Ό**λ‚ **ν‘μ‹ν•  λ°μ΄ν„°** μ κ³µ |
| **λ―Όκ° μ •λ³΄**    | λΉ„λ°€λ²νΈ λ“± **μ…λ ¥** μ •λ³΄ ν¬ν•¨                | λΉ„λ°€λ²νΈ, λ‚΄λ¶€ ν‚¤ λ“± λ―Όκ° μ •λ³΄ **μ κ±°**          |
| **DB λ‚΄λ¶€ μ •λ³΄** | μ„λ²„μ `ID`, `μƒμ„±μΌ` λ“±μ€ **μ—†μ**           | μ„λ²„κ°€ μƒμ„±ν• `ID`, `μ‘μ„±μΌ` λ“± **ν¬ν•¨**         |
| **μ ν¨μ„± κ²€μ‚¬**  | λ°μ΄ν„°κ°€ μ λ€λ΅ λ“¤μ–΄μ™”λ”μ§€ **κ²€μ¦** λ΅μ§ ν•„μ” | κ²€μ¦ λ΅μ§ **λ¶ν•„μ”** (λ°μ΄ν„°λ¥Ό μ£ΌκΈ°λ§ ν•¨)        |
| **μ μ§€λ³΄μ**     | μ…λ ¥ λ°μ΄ν„° κµ¬μ΅°κ°€ λ°”λ€λ©΄ μμ •                | μ¶λ ¥ λ°μ΄ν„° κµ¬μ΅°κ°€ λ°”λ€λ©΄ μμ •                   |

# 4. μΈμ¦, μΈκ°€

## 4-1. μΈμ¦(Authentication)

- μ‚¬μ©μκ°€ μ‹μ¤ν…μ— μμ‹ μ΄ λ„κµ¬μΈμ§€ μ¦λ…ν•λ” κ³Όμ •

- ex. μ›Ήμ‚¬μ΄νΈμ— μ•„μ΄λ””μ™€ λΉ„λ°€λ²νΈλ¥Ό μ…λ ¥ν•΄μ„ λ΅κ·ΈμΈν•λ” κ²ƒ

- μ£Όμ” μ²λ¦¬ μ„μΉ: API κ²μ΄νΈμ›¨μ΄ λλ” Controller μ•λ‹¨(λ³΄μ• ν•„ν„°/μΈν„°μ…‰ν„°)

## 4-2. μΈκ°€(Authorization)

- μΈμ¦λ μ‚¬μ©μκ°€ νΉμ • μμ›μ— μ ‘κ·Όν•κ±°λ‚ μ‚¬μ©ν•  κ¶ν•μ΄ μλ”μ§€ ν™•μΈν•λ” κ³Όμ •

- ex. μΌλ°νμ›μ€ κ²μ‹κΈ€λ§ μ½μ„ μ μκ³ , κ΄€λ¦¬μ μ„¤μ • λ©”λ‰΄λ” λ³Ό μ μ—†μ

- μ²λ¦¬ μ„μΉκ°€ λ‹¤μ–‘ν•¨

  - Controller/API λ‹¨(κ°„λ‹¨ν• κ¶ν• ν™•μΈ)

    - ex. μ΄λ©”μΌ μ£Όμ† ν™•μΈ, κ΄€λ¦¬μ μ—¬λ¶€ ν™•μΈ λ“±
    - @PreAuthorize("hasRole('ADMIN')") μ™€ κ°™μ€ μ–΄λ…Έν…μ΄μ…μ„ Controller λ©”μ†λ“ μ„μ— λ¶™μ—¬μ„ κ΄€λ¦¬μλ§ μ ‘κ·Ό κ°€λ¥ν•κ² λ§‰λ” κ²½μ°

  - Service λ‹¨(λΉ„μ¦λ‹μ¤ λ΅μ§ μ¤‘μ‹¬μ κ¶ν• ν™•μΈ)
    - ex. κ²μ‹κΈ€ Service.μμ •(κ²μ‹κΈ€ Id, μ‚¬μ©μ) λ©”μ†λ“ μ•μ—μ„ "λ§μ•½ ν„μ¬ μ‚¬μ©μκ°€ μ΄ κ²μ‹κΈ€μ μ‘μ„±μ\_ID μ™€ μΌμΉν•μ§€ μ•μΌλ©΄ μ¤λ¥λ¥Ό λ°μƒμ‹μΌλΌ"μ™€ κ°™μ€ μ½”λ“ μ‘μ„±

-> μ •λ¦¬: λ‘ κ³Όμ • λ¨λ‘ μ‹μ¤ν…μ λ³΄μ•μ„ μ±…μ„μ§€μ§€λ§, μΈμ¦μ€ μ…κµ¬μ—μ„ μ‹ μ› ν™•μΈμ„, μΈκ°€λ” μ„λΉ„μ¤ λ΅μ§ λ‚΄λ¶€μ—μ„ κµ¬μ²΄μ μΈ κ¶ν• ν™•μΈ λ‹΄λ‹Ή
